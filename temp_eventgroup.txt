// file: src/app/menu/modifications/components/ModificationsEventGroup.tsx
'use client'

import React from 'react'
import ModificationsRow from './ModificationsRow'
import { Modification } from '@/hooks/useModifications'

interface Props {
  event: {
    eventTitle?: string
    eventCode?: string
    location?: string
    commercial?: string
    count: number
    rows: Modification[]
  }
  onUpdate: (id: string, data: Partial<Modification>) => Promise<any> | void
}

export default function ModificationsEventGroup({ event, onUpdate }: Props) {
  return (
    <div className="border-b last:border-0 px-4 py-3">
      <div className="bg-slate-100 rounded-lg px-3 py-2 mb-2 border flex justify-between items-start">
        <div className="flex flex-col gap-1">
          <div className="flex flex-wrap items-center gap-3">
            <span className="font-semibold text-sm text-slate-900">
              {event.eventTitle || '(Sense títol)'}
            </span>
            {event.eventCode && (
              <span className="text-xs text-slate-600">
                Codi: {event.eventCode}
              </span>
            )}
          </div>
          <div className="flex gap-4 text-xs text-slate-600 flex-wrap">
            <span>{event.location || '-'}</span>
            {event.commercial && <span>Comercial: {event.commercial}</span>}
          </div>
        </div>

        <span className="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-md border border-blue-200">
          {event.count} modificacions
        </span>
      </div>

      <table className="w-full table-fixed text-sm mt-2">
        <thead>
          <tr className="text-xs text-slate-600 bg-slate-50">
            <th className="w-24 p-2 text-left">Nº</th>
            <th className="w-28 p-2 text-left">Autor</th>
            <th className="w-32 p-2 text-left">Dept</th>
            <th className="w-28 p-2 text-left">Importància</th>
            <th className="w-auto p-2 text-left">Descripció</th>
            <th className="w-36 p-2 text-left">Creat</th>
          </tr>
        </thead>
        <tbody>
          {event.rows.map((mod) => (
            <ModificationsRow
              key={mod.id}
              mod={mod}
              onUpdate={onUpdate}
            />
          ))}
        </tbody>
      </table>
    </div>
  )
}

